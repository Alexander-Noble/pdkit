
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Utils &#8212; PDkit 0.2.8 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Gait Processor" href="gait.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-utils">
<span id="utils"></span><h1>Utils<a class="headerlink" href="#module-utils" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="utils.autocorrelate">
<code class="descclassname">utils.</code><code class="descname">autocorrelate</code><span class="sig-paren">(</span><em>data</em>, <em>unbias=2</em>, <em>normalize=2</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.autocorrelate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the autocorrelation coefficients for time series data.
Here we use scipy.signal.correlate, but the results are the same as in
Yang, et al., 2012 for unbias=1:
“The autocorrelation coefficient refers to the correlation of a time
series with its own past or future values. iGAIT uses unbiased
autocorrelation coefficients of acceleration data to scale the regularity
and symmetry of gait.
The autocorrelation coefficients are divided by fc(0) in Eq. (6),
so that the autocorrelation coefficient is equal to 1 when t=0</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NFC</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">fc</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="n">fc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Here NFC(t) is the normalised autocorrelation coefficient, and fc(t) are
autocorrelation coefficients.”
Parameters
———-
data : numpy array</p>
<blockquote>
<div>time series data</div></blockquote>
<dl class="docutils">
<dt>unbias <span class="classifier-delimiter">:</span> <span class="classifier">integer or None</span></dt>
<dd>unbiased autocorrelation: divide by range (1) or by weighted range (2)</dd>
<dt>normalize <span class="classifier-delimiter">:</span> <span class="classifier">integer or None</span></dt>
<dd>normalize: divide by 1st coefficient (1) or by maximum abs. value (2)</dd>
<dt>plot_test <span class="classifier-delimiter">:</span> <span class="classifier">Boolean</span></dt>
<dd>plot?</dd>
</dl>
<dl class="docutils">
<dt>coefficients <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd>[normalized, unbiased] autocorrelation coefficients</dd>
<dt>N <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>number of coefficients</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mhealthx.signals</span> <span class="k">import</span> <span class="n">autocorrelate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unbias</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">normalize</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_test</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coefficients</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">autocorrelate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">unbias</span><span class="p">,</span> <span class="n">normalize</span><span class="p">,</span> <span class="n">plot_test</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.autocorrelation">
<code class="descclassname">utils.</code><code class="descname">autocorrelation</code><span class="sig-paren">(</span><em>signal</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.autocorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>The correlation of a signal with a delayed copy of itself.
More info here: <a class="reference external" href="https://en.wikipedia.org/wiki/Autocorrelation#Estimation">https://en.wikipedia.org/wiki/Autocorrelation#Estimation</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>signal</strong> (<em>array</em>) – A 1-dimensional array or list (the signal).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.butter_lowpass_filter">
<code class="descclassname">utils.</code><code class="descname">butter_lowpass_filter</code><span class="sig-paren">(</span><em>data</em>, <em>sample_rate</em>, <em>cutoff=10</em>, <em>order=4</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.butter_lowpass_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Low-pass filter data by the [order]th order zero lag Butterworth filter
whose cut frequency is set to [cutoff] Hz.
After <a class="reference external" href="http://stackoverflow.com/questions/25191620/">http://stackoverflow.com/questions/25191620/</a>
creating-lowpass-filter-in-scipy-understanding-methods-and-units
Parameters
———-
data : numpy array of floats</p>
<blockquote>
<div>time-series data</div></blockquote>
<dl class="docutils">
<dt>sample_rate <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>data sample rate</dd>
<dt>cutoff <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>filter cutoff</dd>
<dt>order <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>order</dd>
</dl>
<dl class="docutils">
<dt>y <span class="classifier-delimiter">:</span> <span class="classifier">numpy array of floats</span></dt>
<dd>low-pass-filtered data</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mhealthx.signals</span> <span class="k">import</span> <span class="n">butter_lowpass_filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cutoff</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">order</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">butter_lowpass_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.compute_interpeak">
<code class="descclassname">utils.</code><code class="descname">compute_interpeak</code><span class="sig-paren">(</span><em>data</em>, <em>sample_rate</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.compute_interpeak" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute number of samples between signal peaks using the real part of FFT.
Parameters
———-
data : list or numpy array</p>
<blockquote>
<div>time series data</div></blockquote>
<dl class="docutils">
<dt>sample_rate <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>sample rate of accelerometer reading (Hz)</dd>
</dl>
<dl class="docutils">
<dt>interpeak <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd>number of samples between peaks</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mhealthx.signals</span> <span class="k">import</span> <span class="n">compute_interpeak</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">interpeak</span> <span class="o">=</span> <span class="n">compute_interpeak</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.crossings_nonzero_pos2neg">
<code class="descclassname">utils.</code><code class="descname">crossings_nonzero_pos2neg</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.crossings_nonzero_pos2neg" title="Permalink to this definition">¶</a></dt>
<dd><p>Find indices of zero crossings from positive to negative values.
From: <a class="reference external" href="http://stackoverflow.com/questions/3843017/">http://stackoverflow.com/questions/3843017/</a></p>
<blockquote>
<div>efficiently-detect-sign-changes-in-python</div></blockquote>
<p>data : numpy array of floats
Returns
——-
crossings : numpy array of integers</p>
<blockquote>
<div>crossing indices to data</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mhealthx.signals</span> <span class="k">import</span> <span class="n">crossings_nonzero_pos2neg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crossings</span> <span class="o">=</span> <span class="n">crossings_nonzero_pos2neg</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="utils.load_cloudupdrs_data">
<code class="descclassname">utils.</code><code class="descname">load_cloudupdrs_data</code><span class="sig-paren">(</span><em>filename</em>, <em>time_difference=1000000000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.load_cloudupdrs_data" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This method loads data in the cloudupdrs format</p>
<p>Usually the data will be saved in a csv file and it should look like this:</p>
</div></blockquote>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span>timestamp0, x0, y0, z0
timestamp1, x1, y1, z1
timestamp0, x2, y2, z2
.
.
.
timestampn, xn, yn, zn
</pre></div>
</div>
<p>where x, y, z are the components of the acceleration</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) – The path to load data from</li>
<li><strong>time_difference</strong> (<em>float</em>) – Convert times. The default is from from nanoseconds to seconds.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.load_data">
<code class="descclassname">utils.</code><code class="descname">load_data</code><span class="sig-paren">(</span><em>filename</em>, <em>format_file='cloudupdrs'</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a general load data method where the format of data to load can be passed as a parameter,</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) – The path to load data from</li>
<li><strong>format_file</strong> (<em>str</em>) – format of the file. Default is CloudUPDRS. Set to mpower for mpower data.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.load_mpower_data">
<code class="descclassname">utils.</code><code class="descname">load_mpower_data</code><span class="sig-paren">(</span><em>filename</em>, <em>time_difference=1000000000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.load_mpower_data" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>This method loads data in the <a class="reference internal" href="#mpower" id="id1">[mpower]</a> format         
The format is like:</div></blockquote>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span>[
   {
      &quot;timestamp&quot;:19298.67999479167,
      &quot;x&quot;: ... ,
      &quot;y&quot;: ...,
      &quot;z&quot;: ...,
   },
   {...},
   {...}
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) – The path to load data from</li>
<li><strong>time_difference</strong> (<em>float</em>) – Convert times. The default is from from nanoseconds to seconds.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.numerical_integration">
<code class="descclassname">utils.</code><code class="descname">numerical_integration</code><span class="sig-paren">(</span><em>signal</em>, <em>sampling_frequency</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.numerical_integration" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerically integrate a signal with it’s sampling frequency.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>signal</strong> (<em>array</em>) – A 1-dimensional array or list (the signal).</li>
<li><strong>sampling_frequency</strong> (<em>float</em>) – The sampling frequency for the signal.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="utils.peakdet">
<code class="descclassname">utils.</code><code class="descname">peakdet</code><span class="sig-paren">(</span><em>signal</em>, <em>delta</em>, <em>x=None</em><span class="sig-paren">)</span><a class="headerlink" href="#utils.peakdet" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the local maxima and minima (“peaks”) in a 1-dimensional signal.
Converted from MATLAB script at <a class="reference external" href="http://billauer.co.il/peakdet.html">http://billauer.co.il/peakdet.html</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>signal</strong> (<em>array</em>) – A 1-dimensional array or list (the signal).</li>
<li><strong>delta</strong> (<em>float</em>) – The peak threashold. A point is considered a maximum peak if it has the maximal value, and was preceded (to the left) by a value lower by delta.</li>
<li><strong>x</strong> (<em>array</em>) – indices in local maxima and minima are replaced with the corresponding values in x.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<table class="docutils citation" frame="void" id="mpower" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[mpower]</a></td><td><a class="reference external" href="https://www.synapse.org/#!Synapse:syn4993293/wiki/247859">https://www.synapse.org/#!Synapse:syn4993293/wiki/247859</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="correlation" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[correlation]</td><td><a class="reference external" href="https://en.wikipedia.org/wiki/Autocorrelation#Estimation">https://en.wikipedia.org/wiki/Autocorrelation#Estimation</a></td></tr>
</tbody>
</table>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="gait.html" title="previous chapter">Gait Processor</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/utils.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Birkbeck College.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/utils.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>